<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadoras</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="carousel-controls">
    <button class="carousel-control prev">Anterior</button>
    <button class="carousel-control next">Pr√≥ximo</button>
  </div>
  <div class="scroll-container" id="scrollContainer">
    <div class="calculators-list" id="calculatorsList">
      <form id="calculator" class="calculator">
        <h2>Normal Calculator</h2>
        <label for="operationInput">Math Expression:</label>
        <input type="text" id="operationInput" placeholder="Type an operation" />
        <button type="submit">Calculate</button>
        <div class="result" id="normalResultText"></div>
      </form>
      <form class="calculator" id="ruleOfThreeCalculator" autocomplete="off">
        <h2>Rule of Three Calculator</h2>
        <div class="rule-three-block">
          <div class="rule-three-row">
            <input type="number" id="inputA" step="any" placeholder="A" />
            <span class="rule-three-label">IS TO</span>
            <input type="number" id="inputB" step="any" placeholder="B" />
          </div>
          <div class="rule-three-equal">AS</div>
          <div class="rule-three-row">
            <input type="number" id="inputC" step="any" placeholder="C" />
            <span class="rule-three-label">IS TO</span>
            <input type="text" id="inputX" placeholder="X" disabled style="font-weight:bold; font-size:1.2em;" />
          </div>
        </div>
        <button type="submit" style="margin-top:30px;">Calculate</button>
        <div class="result" id="ruleOfThreeResultText"></div>
      </form>
      <form id="leverageCalculator" class="calculator">
        <h2>Leverage Calculator</h2>
        <label>Leverage:</label>
        <input type="number" id="leverage" />
        <label>Percentage Earned (%):</label>
        <input type="number" id="percentage" />
        <button type="submit">Calculate</button>
        <div class="result" id="leveragedProfitResultText"></div>
      </form>
      <form id="profitCalculator" class="calculator">
        <h2>Profit Percentage Calculator</h2>
        <label>Lot Size ($):</label>
        <input type="number" id="lotSize" />
        <label>Profit Amount ($):</label>
        <input type="number" id="profit" />
        <button type="submit">Calculate</button>
        <div class="result" id="profitResultText"></div>
      </form>
      <form id="compoundInterestCalculator" class="calculator">
        <h2>Compound Interest Calculator</h2>
        <label>Initial Investment:</label>
        <input type="number" id="initialInvestment" />
        <label>Monthly Contribution:</label>
        <input type="number" id="contribution" />
        <label>Rate (%):</label>
        <input type="number" id="rate" />
        <label>Period (Months):</label>
        <input type="number" id="period" />
        <button type="submit">Calculate</button>
        <div class="result" id="compoundInterestResultText"></div>
      </form>
      <form class="calculator" id="b3ProfitCalculator" autocomplete="off">
        <h2>B3 Profit Calculator</h2>
        <div class="form-group">
          <label for="contracts">Contracts:</label>
          <input type="number" id="contracts" name="contracts" />
        </div>
        <div class="form-group">
          <label for="type">Type:</label>
          <select id="type" name="type">
            <option value="miniIndice">Mini Index</option>
            <option value="miniDolar">Mini Dollar</option>
            <option value="indice">Index</option>
            <option value="dolar">Dollar</option>
          </select>
        </div>
        <div class="form-group">
          <label for="points">Points:</label>
          <input type="number" id="points" step="0.5" name="points" />
        </div>
        <div class="checkbox-container">
          <span>Tax Deducted</span>
          <input type="checkbox" id="taxDeducted" name="taxDeducted" />
        </div>
        <button type="submit">Calculate</button>
        <div class="result" id="b3ProfitResultText"></div>
      </form>
    </div>
  </div>
  <script src="https://unpkg.com/mathjs@11.8.0/lib/browser/math.js"></script>
  <script>
    // Normal Calculator
    document.getElementById('calculator').addEventListener('submit', function(e){
      e.preventDefault();
      const expr = document.getElementById('operationInput').value.trim();
      const resultDiv = document.getElementById('normalResultText');
      if(expr){
        try{
          const result = math.evaluate(expr);
          resultDiv.textContent = `Result: ${result}`;
        }catch{
          resultDiv.textContent = 'Invalid Expression!';
        }
      } else {
        resultDiv.textContent = 'Please enter a valid expression.';
      }
    });
    // Rule of Three (Novo formato)
    document.getElementById('ruleOfThreeCalculator').addEventListener('submit', function(e){
      e.preventDefault();
      const A = parseFloat(document.getElementById('inputA').value);
      const B = parseFloat(document.getElementById('inputB').value);
      const C = parseFloat(document.getElementById('inputC').value);
      const resultDiv = document.getElementById('ruleOfThreeResultText');
      const inputX = document.getElementById('inputX');
      if (!isNaN(A) && !isNaN(B) && !isNaN(C) && A !== 0) {
        const X = (B * C) / A;
        inputX.value = X.toFixed(4);
        resultDiv.textContent = `X = ${X.toFixed(4)}`;
      } else {
        resultDiv.textContent = 'Please fill all fields.';
        inputX.value = '';
      }
    });
    // Leverage
    document.getElementById('leverageCalculator').addEventListener('submit', function(e){
      e.preventDefault();
      const leverage = parseFloat(document.getElementById('leverage').value);
      const percentage = parseFloat(document.getElementById('percentage').value);
      const resultDiv = document.getElementById('leveragedProfitResultText');
      if (!isNaN(leverage) && !isNaN(percentage)) {
        const result = leverage * percentage;
        resultDiv.textContent = `Leverage Profit: ${result.toFixed(2)}`;
      } else {
        resultDiv.textContent = 'Please fill all fields.';
      }
    });
    // Profit percentage
    document.getElementById('profitCalculator').addEventListener('submit', function(e){
      e.preventDefault();
      const lotSize = parseFloat(document.getElementById('lotSize').value);
      const profit = parseFloat(document.getElementById('profit').value);
      const resultDiv = document.getElementById('profitResultText');
      if (!isNaN(lotSize) && !isNaN(profit) && lotSize !== 0) {
        const result = (profit / lotSize) * 100;
        resultDiv.textContent = `Profit Percentage: ${result.toFixed(2)}%`;
      } else {
        resultDiv.textContent = 'Please fill all fields.';
      }
    });
    // Compound interest
    document.getElementById('compoundInterestCalculator').addEventListener('submit', function(e){
      e.preventDefault();
      const initialInvestment = parseFloat(document.getElementById('initialInvestment').value);
      const contribution = parseFloat(document.getElementById('contribution').value);
      const rate = parseFloat(document.getElementById('rate').value) / 100;
      const period = parseInt(document.getElementById('period').value);
      const resultDiv = document.getElementById('compoundInterestResultText');
      if (!isNaN(initialInvestment) && !isNaN(contribution) && !isNaN(rate) && !isNaN(period)) {
        let finalAmount = initialInvestment * Math.pow(1 + rate, period);
        for(let i = 1; i <= period; i++) {
          finalAmount += contribution * Math.pow(1 + rate, period - i);
        }
        resultDiv.textContent = `Final Amount: $${finalAmount.toFixed(2)}`;
      } else {
        resultDiv.textContent = 'Please fill all fields.';
      }
    });
    // B3 Profit Calculator
    document.getElementById('b3ProfitCalculator').addEventListener('submit', function(e){
      e.preventDefault();
      const contracts = parseInt(document.getElementById('contracts').value, 10);
      const type = document.getElementById('type').value;
      const points = parseFloat(document.getElementById('points').value);
      const taxDeducted = document.getElementById('taxDeducted').checked;
      const resultDiv = document.getElementById('b3ProfitResultText');
      if (isNaN(contracts) || isNaN(points)) {
        resultDiv.textContent = 'Please fill all fields.';
        return;
      }
      let multiplier = 1;
      switch (type) {
        case "miniIndice": multiplier = 0.2; break;
        case "miniDolar":  multiplier = 10; break;
        case "indice":     multiplier = 1; break;
        case "dolar":      multiplier = 50; break;
      }
      let profit = contracts * points * multiplier;
      if (taxDeducted) profit *= 0.8;
      resultDiv.textContent = `Profit: R$ ${profit.toFixed(2)}${taxDeducted ? ' (after 20% tax)' : ''}`;
    });
    // Scroll/Center logic
    const forms = Array.from(document.querySelectorAll('.calculator'));
    let selectedIndex = 0;
    function centerCalculator(idx){
      const calculatorsList = document.getElementById('calculatorsList');
      const scrollContainer = document.getElementById('scrollContainer');
      const calculator = forms[idx];
      const calculatorRect = calculator.getBoundingClientRect();
      const containerRect = scrollContainer.getBoundingClientRect();
      const scrollLeft = calculator.offsetLeft - calculatorsList.offsetLeft - (containerRect.width / 2 - calculatorRect.width / 2);
      scrollContainer.scrollTo({
        left: scrollLeft,
        behavior: 'smooth'
      });
    }
    document.querySelector('.carousel-control.prev').addEventListener('click', function(){
      selectedIndex = selectedIndex > 0 ? selectedIndex - 1 : forms.length - 1;
      centerCalculator(selectedIndex);
    });
    document.querySelector('.carousel-control.next').addEventListener('click', function(){
      selectedIndex = selectedIndex < forms.length - 1 ? selectedIndex + 1 : 0;
      centerCalculator(selectedIndex);
    });
  </script>
</body>
</html>
